{
  "errors": [],
  "generated_at": "2025-08-15T21:37:18Z",
  "metrics": {
    "_totals": {
      "CONFIDENCE.HIGH": 56,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 4,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 3,
      "SEVERITY.LOW": 53,
      "SEVERITY.MEDIUM": 4,
      "SEVERITY.UNDEFINED": 0,
      "loc": 7596,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/music21_mcp/__init__.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 28,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/music21_mcp/adapters/__init__.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 29,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/music21_mcp/adapters/cli_adapter.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 214,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/music21_mcp/adapters/http_adapter.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 2,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 2,
      "SEVERITY.UNDEFINED": 0,
      "loc": 199,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/music21_mcp/adapters/mcp_adapter.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 179,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/music21_mcp/adapters/python_adapter.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 258,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/music21_mcp/async_executor.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 190,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/music21_mcp/health_check.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 40,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/music21_mcp/launcher.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 2,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 2,
      "SEVERITY.UNDEFINED": 0,
      "loc": 182,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/music21_mcp/observability.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 375,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/music21_mcp/parallel_processor.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 109,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/music21_mcp/performance_cache.py": {
      "CONFIDENCE.HIGH": 1,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 1,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 171,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/music21_mcp/performance_optimizations.py": {
      "CONFIDENCE.HIGH": 2,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 2,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 229,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/music21_mcp/resource_manager.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 246,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/music21_mcp/schemas/__init__.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 0,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/music21_mcp/server_minimal.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 131,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/music21_mcp/services.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 204,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/music21_mcp/tools/__init__.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 32,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/music21_mcp/tools/base_tool.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 125,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/music21_mcp/tools/chord_analysis_tool.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 165,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/music21_mcp/tools/counterpoint_tool.py": {
      "CONFIDENCE.HIGH": 15,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 15,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 950,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/music21_mcp/tools/delete_tool.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 49,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/music21_mcp/tools/export_tool.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 110,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/music21_mcp/tools/harmonization_tool.py": {
      "CONFIDENCE.HIGH": 27,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 27,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 839,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/music21_mcp/tools/harmony_analysis_tool.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 235,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/music21_mcp/tools/import_tool.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 222,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/music21_mcp/tools/key_analysis_tool.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 165,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/music21_mcp/tools/list_tool.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 43,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/music21_mcp/tools/pattern_recognition_tool.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 710,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/music21_mcp/tools/score_info_tool.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 255,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/music21_mcp/tools/style_imitation_tool.py": {
      "CONFIDENCE.HIGH": 11,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 11,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 755,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/music21_mcp/tools/voice_leading_tool.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 157,
      "nosec": 0,
      "skipped_tests": 0
    }
  },
  "results": [
    {
      "code": "249     # Get host and port from environment variables with defaults\n250     host = os.getenv(\"MUSIC21_MCP_HOST\", \"0.0.0.0\")\n251     port = int(os.getenv(\"MUSIC21_MCP_PORT\", \"8000\"))\n",
      "col_offset": 41,
      "end_col_offset": 50,
      "filename": "src/music21_mcp/adapters/http_adapter.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 605,
        "link": "https://cwe.mitre.org/data/definitions/605.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible binding to all interfaces.",
      "line_number": 250,
      "line_range": [
        250
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b104_hardcoded_bind_all_interfaces.html",
      "test_id": "B104",
      "test_name": "hardcoded_bind_all_interfaces"
    },
    {
      "code": "251     port = int(os.getenv(\"MUSIC21_MCP_PORT\", \"8000\"))\n252     display_host = \"localhost\" if host == \"0.0.0.0\" else host\n253 \n",
      "col_offset": 42,
      "end_col_offset": 51,
      "filename": "src/music21_mcp/adapters/http_adapter.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 605,
        "link": "https://cwe.mitre.org/data/definitions/605.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible binding to all interfaces.",
      "line_number": 252,
      "line_range": [
        252
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b104_hardcoded_bind_all_interfaces.html",
      "test_id": "B104",
      "test_name": "hardcoded_bind_all_interfaces"
    },
    {
      "code": "78         import os\n79         host = os.getenv(\"MUSIC21_MCP_HOST\", \"0.0.0.0\")\n80         port = int(os.getenv(\"MUSIC21_MCP_PORT\", \"8000\"))\n",
      "col_offset": 45,
      "end_col_offset": 54,
      "filename": "src/music21_mcp/launcher.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 605,
        "link": "https://cwe.mitre.org/data/definitions/605.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible binding to all interfaces.",
      "line_number": 79,
      "line_range": [
        79
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b104_hardcoded_bind_all_interfaces.html",
      "test_id": "B104",
      "test_name": "hardcoded_bind_all_interfaces"
    },
    {
      "code": "81 \n82         display_host = \"localhost\" if host == \"0.0.0.0\" else host\n83         print(f\"\ud83c\udf10 Starting server on http://{display_host}:{port}\")\n",
      "col_offset": 46,
      "end_col_offset": 55,
      "filename": "src/music21_mcp/launcher.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 605,
        "link": "https://cwe.mitre.org/data/definitions/605.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible binding to all interfaces.",
      "line_number": 82,
      "line_range": [
        82
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b104_hardcoded_bind_all_interfaces.html",
      "test_id": "B104",
      "test_name": "hardcoded_bind_all_interfaces"
    },
    {
      "code": "73         # Generate stable hash\n74         return hashlib.md5(cache_key_data.encode()).hexdigest()\n75 \n",
      "col_offset": 15,
      "end_col_offset": 51,
      "filename": "src/music21_mcp/performance_cache.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 327,
        "link": "https://cwe.mitre.org/data/definitions/327.html"
      },
      "issue_severity": "HIGH",
      "issue_text": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
      "line_number": 74,
      "line_range": [
        74
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html",
      "test_id": "B324",
      "test_name": "hashlib"
    },
    {
      "code": "68         pitches = sorted([p.nameWithOctave for p in chord_obj.pitches])\n69         return hashlib.md5(str(pitches).encode()).hexdigest()[:16]\n70 \n",
      "col_offset": 15,
      "end_col_offset": 49,
      "filename": "src/music21_mcp/performance_optimizations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 327,
        "link": "https://cwe.mitre.org/data/definitions/327.html"
      },
      "issue_severity": "HIGH",
      "issue_text": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
      "line_number": 69,
      "line_range": [
        69
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html",
      "test_id": "B324",
      "test_name": "hashlib"
    },
    {
      "code": "237         # Check if we have cached results\n238         score_hash = hashlib.md5(str(score).encode()).hexdigest()[:16]\n239         cache_key = f\"chord_analysis:{score_hash}:{limit}\"\n",
      "col_offset": 21,
      "end_col_offset": 53,
      "filename": "src/music21_mcp/performance_optimizations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 327,
        "link": "https://cwe.mitre.org/data/definitions/327.html"
      },
      "issue_severity": "HIGH",
      "issue_text": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
      "line_number": 238,
      "line_range": [
        238
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html",
      "test_id": "B324",
      "test_name": "hashlib"
    },
    {
      "code": "323                 # First note - perfect consonance\n324                 interval_choice = random.choice(start_intervals)\n325                 cp_pitch = pitch.Pitch(midi=cf_note.pitch.midi + interval_choice)\n",
      "col_offset": 34,
      "end_col_offset": 64,
      "filename": "src/music21_mcp/tools/counterpoint_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 324,
      "line_range": [
        324
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "328                 if voice_position == \"above\":\n329                     interval_choice = random.choice([0, 12])\n330                 else:\n",
      "col_offset": 38,
      "end_col_offset": 60,
      "filename": "src/music21_mcp/tools/counterpoint_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 329,
      "line_range": [
        329
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "330                 else:\n331                     interval_choice = random.choice([-12, 0])\n332                 cp_pitch = pitch.Pitch(midi=cf_note.pitch.midi + interval_choice)\n",
      "col_offset": 38,
      "end_col_offset": 61,
      "filename": "src/music21_mcp/tools/counterpoint_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 331,
      "line_range": [
        331
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "571             if stepwise_candidates:\n572                 return random.choice(stepwise_candidates)\n573 \n",
      "col_offset": 23,
      "end_col_offset": 57,
      "filename": "src/music21_mcp/tools/counterpoint_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 572,
      "line_range": [
        572
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "573 \n574         return random.choice(candidates) if candidates else available_pitches[0]\n575 \n",
      "col_offset": 15,
      "end_col_offset": 40,
      "filename": "src/music21_mcp/tools/counterpoint_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 574,
      "line_range": [
        574
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "663                 ]\n664                 if neighbors and random.random() < 0.3:\n665                     return random.choice(neighbors)\n",
      "col_offset": 33,
      "end_col_offset": 48,
      "filename": "src/music21_mcp/tools/counterpoint_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 664,
      "line_range": [
        664
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "664                 if neighbors and random.random() < 0.3:\n665                     return random.choice(neighbors)\n666 \n",
      "col_offset": 27,
      "end_col_offset": 51,
      "filename": "src/music21_mcp/tools/counterpoint_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 665,
      "line_range": [
        665
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "671             if stepwise:\n672                 return random.choice(stepwise)\n673 \n",
      "col_offset": 23,
      "end_col_offset": 46,
      "filename": "src/music21_mcp/tools/counterpoint_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 672,
      "line_range": [
        672
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "673 \n674         return random.choice(candidates) if candidates else available_pitches[0]\n675 \n",
      "col_offset": 15,
      "end_col_offset": 40,
      "filename": "src/music21_mcp/tools/counterpoint_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 674,
      "line_range": [
        674
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "793             if imperfect:\n794                 return random.choice(imperfect)\n795             return random.choice(consonant)\n",
      "col_offset": 23,
      "end_col_offset": 47,
      "filename": "src/music21_mcp/tools/counterpoint_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 794,
      "line_range": [
        794
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "794                 return random.choice(imperfect)\n795             return random.choice(consonant)\n796 \n",
      "col_offset": 19,
      "end_col_offset": 43,
      "filename": "src/music21_mcp/tools/counterpoint_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 795,
      "line_range": [
        795
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "818             else:\n819                 species_choice = random.choice(\n820                     [\n821                         Species.FIRST,\n822                         Species.SECOND,\n823                         Species.SECOND,  # Weight towards 2:1\n824                         Species.THIRD,\n825                         Species.FOURTH,\n826                     ]\n827                 )\n828 \n",
      "col_offset": 33,
      "end_col_offset": 17,
      "filename": "src/music21_mcp/tools/counterpoint_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 819,
      "line_range": [
        819,
        820,
        821,
        822,
        823,
        824,
        825,
        826,
        827
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "878 \n879         interval_choice = random.choice(options)\n880         return pitch.Pitch(midi=cf_note.pitch.midi + interval_choice)\n",
      "col_offset": 26,
      "end_col_offset": 48,
      "filename": "src/music21_mcp/tools/counterpoint_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 879,
      "line_range": [
        879
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "904         if voice_position == \"above\":\n905             interval_choice = random.choice([0, 12])  # Unison or octave\n906         else:\n",
      "col_offset": 30,
      "end_col_offset": 52,
      "filename": "src/music21_mcp/tools/counterpoint_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 905,
      "line_range": [
        905
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "906         else:\n907             interval_choice = random.choice([-12, 0])\n908 \n",
      "col_offset": 30,
      "end_col_offset": 53,
      "filename": "src/music21_mcp/tools/counterpoint_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 907,
      "line_range": [
        907
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "144             harmonized_score = harmonization[\"score\"]\n145             assert isinstance(harmonized_score, stream.Score)\n146             style_vocab = self.style_vocabularies.get(style, {})\n",
      "col_offset": 12,
      "end_col_offset": 61,
      "filename": "src/music21_mcp/tools/harmonization_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 145,
      "line_range": [
        145
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "151             )\n152             assert isinstance(voice_leading_style, str)\n153             voice_leading_check = self._check_voice_leading(\n",
      "col_offset": 12,
      "end_col_offset": 55,
      "filename": "src/music21_mcp/tools/harmonization_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 152,
      "line_range": [
        152
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "170             harmonized_score = harmonization[\"score\"]\n171             assert isinstance(harmonized_score, stream.Score)\n172             self.score_manager[harmonized_id] = harmonized_score\n",
      "col_offset": 12,
      "end_col_offset": 61,
      "filename": "src/music21_mcp/tools/harmonization_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 171,
      "line_range": [
        171
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "379             confidence_list = result[\"confidence_ratings\"]\n380             assert isinstance(progression_list, list)\n381             assert isinstance(roman_list, list)\n",
      "col_offset": 12,
      "end_col_offset": 53,
      "filename": "src/music21_mcp/tools/harmonization_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 380,
      "line_range": [
        380
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "380             assert isinstance(progression_list, list)\n381             assert isinstance(roman_list, list)\n382             assert isinstance(confidence_list, list)\n",
      "col_offset": 12,
      "end_col_offset": 47,
      "filename": "src/music21_mcp/tools/harmonization_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 381,
      "line_range": [
        381
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "381             assert isinstance(roman_list, list)\n382             assert isinstance(confidence_list, list)\n383             progression_list.append(chord_symbol)\n",
      "col_offset": 12,
      "end_col_offset": 52,
      "filename": "src/music21_mcp/tools/harmonization_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 382,
      "line_range": [
        382
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "388         score_obj = result[\"score\"]\n389         assert isinstance(score_obj, stream.Score)\n390         score_obj.insert(0, soprano)\n",
      "col_offset": 8,
      "end_col_offset": 50,
      "filename": "src/music21_mcp/tools/harmonization_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 389,
      "line_range": [
        389
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "412         # Use common progressions as templates\n413         template = random.choice(self.common_progressions[\"classical\"])\n414         template_length = len(template)\n",
      "col_offset": 19,
      "end_col_offset": 71,
      "filename": "src/music21_mcp/tools/harmonization_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 413,
      "line_range": [
        413
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "427                 # Phrase cadence - use V or vi\n428                 chord_choice = random.choice([\"V\", \"vi\"])\n429             else:\n",
      "col_offset": 31,
      "end_col_offset": 57,
      "filename": "src/music21_mcp/tools/harmonization_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 428,
      "line_range": [
        428
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "579             confidence_list = result[\"confidence_ratings\"]\n580             assert isinstance(progression_list, list)\n581             assert isinstance(roman_list, list)\n",
      "col_offset": 12,
      "end_col_offset": 53,
      "filename": "src/music21_mcp/tools/harmonization_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 580,
      "line_range": [
        580
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "580             assert isinstance(progression_list, list)\n581             assert isinstance(roman_list, list)\n582             assert isinstance(confidence_list, list)\n",
      "col_offset": 12,
      "end_col_offset": 47,
      "filename": "src/music21_mcp/tools/harmonization_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 581,
      "line_range": [
        581
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "581             assert isinstance(roman_list, list)\n582             assert isinstance(confidence_list, list)\n583             progression_list.append(chord_symbol)\n",
      "col_offset": 12,
      "end_col_offset": 52,
      "filename": "src/music21_mcp/tools/harmonization_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 582,
      "line_range": [
        582
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "587         score_obj = result[\"score\"]\n588         assert isinstance(score_obj, stream.Score)\n589         score_obj.insert(0, right_hand)\n",
      "col_offset": 8,
      "end_col_offset": 50,
      "filename": "src/music21_mcp/tools/harmonization_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 588,
      "line_range": [
        588
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "604         templates = self.common_progressions[\"jazz\"]\n605         template = random.choice(templates)\n606 \n",
      "col_offset": 19,
      "end_col_offset": 43,
      "filename": "src/music21_mcp/tools/harmonization_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 605,
      "line_range": [
        605
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "612             # Apply jazz substitutions\n613             if random.random() < 0.3 and (\n614                 not constraints or \"no_substitutions\" not in constraints\n",
      "col_offset": 15,
      "end_col_offset": 30,
      "filename": "src/music21_mcp/tools/harmonization_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 613,
      "line_range": [
        613
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "619                 # Modal interchange\n620                 elif \"IMaj7\" in base_chord and random.random() < 0.5:\n621                     base_chord = \"IMaj7#11\"\n",
      "col_offset": 47,
      "end_col_offset": 62,
      "filename": "src/music21_mcp/tools/harmonization_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 620,
      "line_range": [
        620
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "725             roman_list = result[\"roman_numerals\"]\n726             assert isinstance(progression_list, list)\n727             assert isinstance(roman_list, list)\n",
      "col_offset": 12,
      "end_col_offset": 53,
      "filename": "src/music21_mcp/tools/harmonization_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 726,
      "line_range": [
        726
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "726             assert isinstance(progression_list, list)\n727             assert isinstance(roman_list, list)\n728             progression_list.append(chord_symbol)\n",
      "col_offset": 12,
      "end_col_offset": 47,
      "filename": "src/music21_mcp/tools/harmonization_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 727,
      "line_range": [
        727
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "731         score_obj = result[\"score\"]\n732         assert isinstance(score_obj, stream.Score)\n733         score_obj.insert(0, melody_part)\n",
      "col_offset": 8,
      "end_col_offset": 50,
      "filename": "src/music21_mcp/tools/harmonization_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 732,
      "line_range": [
        732
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "747         progression_templates = self.common_progressions[\"pop\"]\n748         template = random.choice(progression_templates)\n749 \n",
      "col_offset": 19,
      "end_col_offset": 55,
      "filename": "src/music21_mcp/tools/harmonization_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 748,
      "line_range": [
        748
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "766                 and pop_vocab.get(\"power_chords\")\n767                 and random.random() < 0.3\n768             ):\n",
      "col_offset": 20,
      "end_col_offset": 35,
      "filename": "src/music21_mcp/tools/harmonization_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 767,
      "line_range": [
        767
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "825             roman_list = result[\"roman_numerals\"]\n826             assert isinstance(progression_list, list)\n827             assert isinstance(roman_list, list)\n",
      "col_offset": 12,
      "end_col_offset": 53,
      "filename": "src/music21_mcp/tools/harmonization_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 826,
      "line_range": [
        826
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "826             assert isinstance(progression_list, list)\n827             assert isinstance(roman_list, list)\n828             progression_list.append(chord_symbol)\n",
      "col_offset": 12,
      "end_col_offset": 47,
      "filename": "src/music21_mcp/tools/harmonization_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 827,
      "line_range": [
        827
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "831         score_obj = result[\"score\"]\n832         assert isinstance(score_obj, stream.Score)\n833         score_obj.insert(0, melody_part)\n",
      "col_offset": 8,
      "end_col_offset": 50,
      "filename": "src/music21_mcp/tools/harmonization_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 832,
      "line_range": [
        832
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "884                 if compatible_chords:\n885                     chord_choice = random.choice(compatible_chords)\n886                 else:\n",
      "col_offset": 35,
      "end_col_offset": 67,
      "filename": "src/music21_mcp/tools/harmonization_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 885,
      "line_range": [
        885
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "968                         parallel_fifths = quality[\"parallel_fifths\"]\n969                         assert isinstance(parallel_fifths, int)\n970                         quality[\"parallel_fifths\"] = parallel_fifths + 1\n",
      "col_offset": 24,
      "end_col_offset": 63,
      "filename": "src/music21_mcp/tools/harmonization_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 969,
      "line_range": [
        969
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "972                         parallel_octaves = quality[\"parallel_octaves\"]\n973                         assert isinstance(parallel_octaves, int)\n974                         quality[\"parallel_octaves\"] = parallel_octaves + 1\n",
      "col_offset": 24,
      "end_col_offset": 64,
      "filename": "src/music21_mcp/tools/harmonization_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 973,
      "line_range": [
        973
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "707 \n708         if random.random() < stepwise_pref:\n709             # Stepwise motion\n",
      "col_offset": 11,
      "end_col_offset": 26,
      "filename": "src/music21_mcp/tools/style_imitation_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 708,
      "line_range": [
        708
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "709             # Stepwise motion\n710             step = random.choice([-2, -1, 1, 2])\n711         else:\n",
      "col_offset": 19,
      "end_col_offset": 48,
      "filename": "src/music21_mcp/tools/style_imitation_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 710,
      "line_range": [
        710
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "713             leap_size = style_data.get(\"melodic\", {}).get(\"avg_interval\", 3)\n714             step = random.choice([-1, 1]) * random.randint(3, int(leap_size * 2))\n715 \n",
      "col_offset": 19,
      "end_col_offset": 41,
      "filename": "src/music21_mcp/tools/style_imitation_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 714,
      "line_range": [
        714
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "713             leap_size = style_data.get(\"melodic\", {}).get(\"avg_interval\", 3)\n714             step = random.choice([-1, 1]) * random.randint(3, int(leap_size * 2))\n715 \n",
      "col_offset": 44,
      "end_col_offset": 81,
      "filename": "src/music21_mcp/tools/style_imitation_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 714,
      "line_range": [
        714
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "725             if durations:\n726                 return float(random.choice(durations))\n727 \n",
      "col_offset": 29,
      "end_col_offset": 53,
      "filename": "src/music21_mcp/tools/style_imitation_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 726,
      "line_range": [
        726
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "734             if avg_dur < 0.5:\n735                 return random.choice([0.25, 0.5])\n736             elif avg_dur > 1.5:\n",
      "col_offset": 23,
      "end_col_offset": 49,
      "filename": "src/music21_mcp/tools/style_imitation_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 735,
      "line_range": [
        735
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "736             elif avg_dur > 1.5:\n737                 return random.choice([1.0, 2.0])\n738             else:\n",
      "col_offset": 23,
      "end_col_offset": 48,
      "filename": "src/music21_mcp/tools/style_imitation_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 737,
      "line_range": [
        737
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "738             else:\n739                 return random.choice([0.5, 1.0])\n740         \n",
      "col_offset": 23,
      "end_col_offset": 48,
      "filename": "src/music21_mcp/tools/style_imitation_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 739,
      "line_range": [
        739
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "743             if avg_dur < 0.5:\n744                 return random.choice([0.125, 0.25, 0.5, 0.75])\n745             elif avg_dur > 1.5:\n",
      "col_offset": 23,
      "end_col_offset": 62,
      "filename": "src/music21_mcp/tools/style_imitation_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 744,
      "line_range": [
        744
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "745             elif avg_dur > 1.5:\n746                 return random.choice([0.5, 1.0, 1.5, 2.0])\n747             else:\n",
      "col_offset": 23,
      "end_col_offset": 58,
      "filename": "src/music21_mcp/tools/style_imitation_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 746,
      "line_range": [
        746
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "747             else:\n748                 return random.choice([0.25, 0.5, 1.0, 1.5])\n749         \n",
      "col_offset": 23,
      "end_col_offset": 59,
      "filename": "src/music21_mcp/tools/style_imitation_tool.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 748,
      "line_range": [
        748
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    }
  ]
}